<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xzsd.pc.scroll.dao.ScrollDao">

    <!--轮播图列表-->
    <select id="listScroll" parameterType="com.xzsd.pc.scroll.entity.ScrollInfo" resultType="com.xzsd.pc.scroll.entity.ScrollInfo">
        select
            sort,
            picture_path picturePath,
            state,
            begin,
            end,
            version
        from t_scroll
        where is_deleted = 0
        <if test="state != null and state != ''">
            and state = #{state}
        </if>
    </select>

    <!--删除轮播图-->
    <update id="deleteScroll" parameterType="com.xzsd.pc.scroll.entity.ScrollInfo">
        update
            t_scroll
        set is_deleted=1
        where p_id in
        <foreach index="index" item="Pid" collection="scrollList" open="(" separator="," close=")">
            #{Pid}
        </foreach>
    </update>

    <!--商品启用/停用接口-->
    <update id="stateGoods" parameterType="com.xzsd.pc.scroll.entity.ScrollInfo">
        update
            t_scroll
        set state=#{state}
        where p_id=#{pId}
    </update>

    <!--新增轮播图-->
    <insert id="saveScroll" parameterType="com.xzsd.pc.scroll.entity.ScrollInfo">
        insert into
            t_scroll
                (p_id,
                 c_id,
                 picture_path,
                 sort,
                 begin,
                 end,
                 state,
                 version)
         values
         (#{pId},
          #{cId},
          #{picturePath},
          #{sort},
          #{begin},
          #{end},
          #{state},
          0)
    </insert>
    <!--查询商品-->
    <select id="listGoods" parameterType="com.xzsd.pc.goods.entity.GoodsInfo" resultType="com.xzsd.pc.goods.entity.GoodsInfo">
        select
            c_id,
            c_name,
            state,
            first_classify,
            second_classify secondClassify,
            image_path
        from t_commodity
        where is_deleted = 0
        <if test="cName != null and cName !=''">
            and c_name = #{cName}
        </if>
        <if test="cId != null and cId !=''">
            and c_id = #{cId}
        </if>
    </select>
    <!--修改轮播图状态-->
    <update id="stateScroll" parameterType="com.xzsd.pc.scroll.entity.ScrollInfo">
        update t_scroll
        set
            state = #{state},
            version = version +1
        where p_id in
        <foreach collection="idList" item="pId" index="index" open="(" separator="," close=")">
            #{pId}
        </foreach>
    </update>


</mapper>